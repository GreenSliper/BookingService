<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BookingService Test</title>
</head>
<body>
<h2>Login</h2>
<label>Email:</label>
<input id="email" type="text"><br><br>

<label>Password:</label>
<input id="password" type="password"><br><br>

<button onclick="login()">Login</button>

<h3>Access Token:</h3>
<pre id="token"></pre>

<hr>

<h2>Test Authorized Request</h2>
<button onclick="testAuth()">Call /api/properties</button>

<h3>Response:</h3>
<pre id="response"></pre>

<script>
    let accessToken = null;

    async function login() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        const res = await fetch("http://localhost:5000/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
        });

        const data = await res.json();
        accessToken = data.accessToken;

        document.getElementById("token").textContent = accessToken
            ? data.accessToken
            : "Login failed";
    }

    async function testAuth() {
        if (!accessToken) {
            document.getElementById("response").textContent = "No token! Login first.";
            return;
        }

        const res = await fetch("https://localhost:7137/api/properties/test", {
            method: "GET",
            headers: {
                "Authorization": "Bearer " + accessToken
            }
        });

        const text = await res.text();
        document.getElementById("response").textContent = text;
    }
</script>

</body>
</html>
